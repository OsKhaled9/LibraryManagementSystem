@model List<UserFormViewModel>
@{
    ViewData["Title"] = "Users";
}

<div class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold text-primary">
            👤 All Users in Library
        </h2>
        <div class="d-flex gap-2">
            <a asp-controller="Users" asp-action="Add" class="btn btn-primary px-4">
                <i class="bi bi-plus-circle me-1"></i> Add New User
            </a>
            <a asp-controller="Home" asp-action="Index" class="btn btn-secondary px-4">
                <i class="bi bi-arrow-left-circle me-1"></i> Back to Home
            </a>
        </div>
    </div>

    <table class="table table-hover mb-0">
        <thead class="table-primary">
            <tr>
                <th class="text-center">Full Name</th>
                <th class="text-center">Address</th>
                <th class="text-center">Phone</th>
                <th class="text-center">Role</th>
                <th class="text-center">User Type</th>
                <th class="text-center">No. Books Available</th>
                <th class="text-center">Status</th>
                <th class="text-center"></th>
            </tr>
        </thead>
        <tbody>
            @if (Model is not null && Model.Any())
            {
                @foreach (var user in Model)
                {
                    string rowColor = "#ffffff";

                    if (user.UserType == enTypesNames.VIP.ToString())
                    {
                        rowColor = "#ffe6e6";
                    }
                    else if (user.UserType == enTypesNames.Premium.ToString())
                    {
                        rowColor = "#fff7e6";
                    }

                    <tr style="background-color:@rowColor; white-space:nowrap;">
                        <td class="text-center">@user.FirstName @user.LastName</td>
                        <td class="text-center">@user.Address</td>
                        <td class="text-center">@user.PhoneNumber</td>
                        <td class="text-center">
                            <span class="badge @(user.RoleName == "Admin" ? "bg-primary" : "bg-info")">
                                @user.RoleName
                            </span>
                        </td>
                        <td class="text-center">
                            @if (user.UserType == enTypesNames.VIP.ToString())
                            {
                                <span style="color:red; font-weight:bold;">VIP ⭐👑⭐</span>
                            }
                            else if (user.UserType == enTypesNames.Premium.ToString())
                            {
                                <span style="color:orange; font-weight:bold;">Premium ⭐</span>
                            }
                            else
                            {
                                <span style="color:green; font-weight:bold;">Normal</span>
                            }
                        </td>
                        <td class="text-center">@user.NumberOfBooksAvailable</td>
                        <td class="text-center">
                            <span class="@(user.IsActive ? "badge badge-success" : "badge badge-danger") fs-6">
                                @(user.IsActive ? "Active" : "Inactive")
                            </span>
                        </td>

                        <td class="text-center">
                            <a asp-controller="Users" asp-action="Details" asp-route-id="@user.UserId" class="btn btn-outline-primary btn-sm">
                                <i class="bi bi-eye me-1"></i> View
                            </a>

                            <a asp-controller="Users" asp-action="Edit" asp-route-id="@user.UserId" class="btn btn-outline-info btn-sm">
                                <i class="bi bi-pencil me-1"></i> Edit
                            </a>

                            <a href="javascript:;" class="btn btn-outline-danger btn-sm js-delete"
                               data-id="@user.UserId"
                               data-url="/Users/Delete/"
                               data-name="@($"{user.FirstName} {user.LastName}")"
                               data-entity-type="User"
                               data-redirectAction="/Users/Index">
                                <i class="bi bi-trash me-1"></i>Delete
                            </a>
                        </td>
                    </tr>
                }
            }
            else
            {
                <tr>
                    <td colspan="6" class="text-center text-muted py-4">
                        <i class="bi bi-info-circle text-info me-2"></i> No Users found.
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

@Html.AntiForgeryToken()

@section Scripts {
    <script>
        $(document).ready(function(){
            bootBoxDelete();
        });
    </script>
}